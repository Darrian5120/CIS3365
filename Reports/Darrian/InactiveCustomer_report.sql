USE CoogTechSolutions

SELECT Customer.C_FNAME AS "First Name", Customer.C_LNAME AS "Last Name", 
CUSTOMER_CONTACT_INFO.C_PHONE AS "Phone", CUSTOMER_STATUS.ACTIVE

FROM Customer
JOIN CUSTOMER_STATUS
ON Customer.CUSTOMER_ID = CUSTOMER_STATUS.CUSTOMER_ID
JOIN CUSTOMER_CONTACT_INFO
ON Customer.CUSTOMER_ID = CUSTOMER_CONTACT_INFO.CUSTOMER_ID
JOIN CUSTOMER_ORDER
ON Customer.CUSTOMER_ID = CUSTOMER_ORDER.CUSTOMER_ID
JOIN SERVICE_ORDER
ON CUSTOMER_ORDER.SERVICE_ORDER_ID = SERVICE_ORDER.SERVICE_ORDER_ID

WHERE CUSTOMER_STATUS.C_ACTIVE = 2 OR CUSTOMER_STATUS.C_ACTIVE = 4 /*OR SERVICE_ORDER.ORDER_DATE < GETDATE()*/
ORDER BY CUSTOMER.C_LNAME, CUSTOMER.C_FNAME;
